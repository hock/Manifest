/*! Manifest 2023-08-30 */
import fetch from"node-fetch";function InitService(e){console.log(e);e=require("express")();const t=require("url"),r=require("request-promise"),o="hockbook.local",c="AIzaSyDbKq9njfiQa3UDGzRaaG0YaQOT0kYNoFQ";e.listen(3e3,o,()=>{console.log(`Server running at ${o}:3000/`)}),e.get("/",(e,o)=>{let s={g:null,r:null,getSmapGeo:function(e){return r({method:"GET",uri:"https://raw.githubusercontent.com/hock/smapdata/master/data/"+e+".geojson",json:!0})},getSmapGraph:function(e){return r({method:"GET",uri:"https://raw.githubusercontent.com/hock/smapdata/master/data/"+e+".json",json:!0})},getGoogleOverview:function(e){return r({uri:"https://sheets.googleapis.com/v4/spreadsheets/"+e+"/values/Overview?key="+c,json:!0})},getGoogleList:function(e){return r({method:"GET",uri:"https://sheets.googleapis.com/v4/spreadsheets/"+e+"/values/List?key="+c,json:!0})},getMarineTrafficOverview:function(){return r({method:"GET",uri:"http://services.marinetraffic.com/api/exportvessels/cc503f48eb2c8e49549cc56de3c7059c4b042931/timespan:4/protocol:json",json:!0})},getAprsFi:function(e){return r({method:"GET",uri:"https://api.aprs.fi/api/get?name="+e+"&what=loc&apikey=161937.xJdpU4VkxgfJ2EA&format=json",headers:{"User-Agent":"manifest/0.2 (+https://manifest.supplystudies.com/)"},json:!0})}};let n=t.parse(e.url,!0).query;if("smap"==n.type||"gsheet"==n.type){let e=null,t=null;"smap"==n.type&&(e=s.getSmapGeo,t=s.getSmapGraph),"gsheet"==n.type&&(e=s.getGoogleOverview,t=s.getGoogleList),e(n.id).then(function(e){s.g=e,t(n.id).then(function(e){s.r=e,o.statusCode=200,o.setHeader("Access-Control-Allow-Origin","*"),o.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),o.setHeader("Access-Control-Allow-Methods","GET"),o.setHeader("Content-Type","application/json"),console.log("done"),o.end('{"g": '+JSON.stringify(s.g)+', "r": '+JSON.stringify(s.r)+"}")}).catch(function(e){console.log("failed"),o.statusCode=404,o.setHeader("Access-Control-Allow-Origin","*"),o.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),o.setHeader("Access-Control-Allow-Methods","GET"),o.setHeader("Content-Type","application/json"),o.end('{"not found"}')})}).catch(function(e){console.log("failed"),o.statusCode=404,o.setHeader("Access-Control-Allow-Origin","*"),o.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),o.setHeader("Access-Control-Allow-Methods","GET"),o.setHeader("Content-Type","application/json"),o.end('{"not found"}')})}"proxy-marine"==n.type&&s.getMarineTrafficOverview().then(function(e){o.statusCode=200,o.setHeader("Access-Control-Allow-Origin","*"),o.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),o.setHeader("Access-Control-Allow-Methods","GET"),o.setHeader("Content-Type","application/json"),console.log("success"),o.end(JSON.stringify(e))}).catch(function(e){console.log("failed"),o.statusCode=404,o.setHeader("Access-Control-Allow-Origin","*"),o.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),o.setHeader("Access-Control-Allow-Methods","GET"),o.setHeader("Content-Type","application/json"),o.end('{"not found"}')}),"aprsfi"==n.type&&s.getAprsFi(n.id).then(function(e){o.statusCode=200,o.setHeader("Access-Control-Allow-Origin","*"),o.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),o.setHeader("Access-Control-Allow-Methods","GET"),o.setHeader("Content-Type","application/json"),console.log("success"),o.end(JSON.stringify(e))}).catch(function(e){console.log("failed"),o.statusCode=404,o.setHeader("Access-Control-Allow-Origin","*"),o.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),o.setHeader("Access-Control-Allow-Methods","GET"),o.setHeader("Content-Type","application/json"),o.end('{"error: "RESOURCE NOT FOUND"}')})})}fetch("keys.json").then(e=>InitService(e));
//# sourceMappingURL=manifester.min.js.map